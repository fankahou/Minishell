<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Minishell: history.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Minishell
   </div>
   <div id="projectbrief">A simple UNIX shell</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('history_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">history.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="minishell_8h_source.html">minishell.h</a>&quot;</code><br />
</div>
<p><a href="history_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a450023d4166b960ed99a6999c2d87dc0" id="r_a450023d4166b960ed99a6999c2d87dc0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a450023d4166b960ed99a6999c2d87dc0">history_add</a> (<a class="el" href="structt__history.html">t_history</a> *history, char *command)</td></tr>
<tr class="memdesc:a450023d4166b960ed99a6999c2d87dc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add an entry to the history.  <br /></td></tr>
<tr class="separator:a450023d4166b960ed99a6999c2d87dc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdb3ff3b94e0a7d4212f4d6df994baf5" id="r_abdb3ff3b94e0a7d4212f4d6df994baf5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abdb3ff3b94e0a7d4212f4d6df994baf5">read_history_file</a> (<a class="el" href="structt__history.html">t_history</a> *history, int fd)</td></tr>
<tr class="memdesc:abdb3ff3b94e0a7d4212f4d6df994baf5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads history file into history.  <br /></td></tr>
<tr class="separator:abdb3ff3b94e0a7d4212f4d6df994baf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6cfd171bf348ba5967396f960600478" id="r_af6cfd171bf348ba5967396f960600478"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af6cfd171bf348ba5967396f960600478">init_history</a> (<a class="el" href="structt__history.html">t_history</a> *history)</td></tr>
<tr class="memdesc:af6cfd171bf348ba5967396f960600478"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the history of the minishell.  <br /></td></tr>
<tr class="separator:af6cfd171bf348ba5967396f960600478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44c6663b05e578ce389d3c8ca60e4aec" id="r_a44c6663b05e578ce389d3c8ca60e4aec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a44c6663b05e578ce389d3c8ca60e4aec">history_write</a> (<a class="el" href="structt__history.html">t_history</a> history)</td></tr>
<tr class="memdesc:a44c6663b05e578ce389d3c8ca60e4aec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes the current history to the history file.  <br /></td></tr>
<tr class="separator:a44c6663b05e578ce389d3c8ca60e4aec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1df932fa029cbcc44919cb69b49384c" id="r_af1df932fa029cbcc44919cb69b49384c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af1df932fa029cbcc44919cb69b49384c">destroy_history</a> (<a class="el" href="structt__history.html">t_history</a> *history)</td></tr>
<tr class="memdesc:af1df932fa029cbcc44919cb69b49384c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys the history of the minishell.  <br /></td></tr>
<tr class="separator:af1df932fa029cbcc44919cb69b49384c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="af1df932fa029cbcc44919cb69b49384c" name="af1df932fa029cbcc44919cb69b49384c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1df932fa029cbcc44919cb69b49384c">&#9670;&#160;</a></span>destroy_history()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroy_history </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__history.html">t_history</a> *</td>          <td class="paramname"><span class="paramname"><em>history</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroys the history of the minishell. </p>
<p>This function destroys the current history. All entries are written to the history file using <a class="el" href="#a44c6663b05e578ce389d3c8ca60e4aec" title="Writes the current history to the history file.">history_write()</a> before the history is destroyed.</p>
<dl class="section author"><dt>Author</dt><dd>kmautner</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">history</td><td>history struct </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="history_8c_source.html#l00167">167</a> of file <a class="el" href="history_8c_source.html">history.c</a>.</p>

<p class="reference">References <a class="el" href="error_8c_source.html#l00113">debug()</a>, <a class="el" href="error_8c_source.html#l00058">error()</a>, <a class="el" href="history_8c_source.html#l00136">history_write()</a>, and <a class="el" href="minishell_8h_source.html#l00201">t_history::list</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00107">free_all()</a>.</p>

</div>
</div>
<a id="a450023d4166b960ed99a6999c2d87dc0" name="a450023d4166b960ed99a6999c2d87dc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a450023d4166b960ed99a6999c2d87dc0">&#9670;&#160;</a></span>history_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int history_add </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__history.html">t_history</a> *</td>          <td class="paramname"><span class="paramname"><em>history</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>command</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add an entry to the history. </p>
<p>This function adds a malloc'd string to the history. If an equal string is already the latest entry in history, it will get free'd and ignored.</p>
<dl class="section author"><dt>Author</dt><dd>kmautner</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">history</td><td>history struct </td></tr>
    <tr><td class="paramname">command</td><td>entry to add to history </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">success</td><td>Returns 0 on success, 1 otherwise. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="history_8c_source.html#l00029">29</a> of file <a class="el" href="history_8c_source.html">history.c</a>.</p>

<p class="reference">References <a class="el" href="error_8c_source.html#l00113">debug()</a>, <a class="el" href="minishell_8h_source.html#l00055">HISTORY_MAX_SIZE</a>, <a class="el" href="minishell_8h_source.html#l00202">t_history::length</a>, <a class="el" href="minishell_8h_source.html#l00201">t_history::list</a>, <a class="el" href="utils__history_8c_source.html#l00053">shift_array()</a>, and <a class="el" href="utils__history_8c_source.html#l00030">str_equals()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00180">main()</a>, and <a class="el" href="history_8c_source.html#l00066">read_history_file()</a>.</p>

</div>
</div>
<a id="a44c6663b05e578ce389d3c8ca60e4aec" name="a44c6663b05e578ce389d3c8ca60e4aec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44c6663b05e578ce389d3c8ca60e4aec">&#9670;&#160;</a></span>history_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int history_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__history.html">t_history</a></td>          <td class="paramname"><span class="paramname"><em>history</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes the current history to the history file. </p>
<p>This function opens the history file, truncates it and writes the current history to the file. Should the file not exist it will be created. If the file cannot be opened execution will stop and the current history will get lost. Write fails are ignored and may lead to a corrupted file.</p>
<dl class="section author"><dt>Author</dt><dd>kmautner</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">history</td><td>history struct </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">success</td><td>Returns 0 on success, 1 otherwise. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="history_8c_source.html#l00136">136</a> of file <a class="el" href="history_8c_source.html">history.c</a>.</p>

<p class="reference">References <a class="el" href="error_8c_source.html#l00113">debug()</a>, <a class="el" href="error_8c_source.html#l00058">error()</a>, <a class="el" href="ft__strlen_8c_source.html#l00016">ft_strlen()</a>, <a class="el" href="minishell_8h_source.html#l00066">HISTORY_FILE</a>, <a class="el" href="minishell_8h_source.html#l00202">t_history::length</a>, and <a class="el" href="minishell_8h_source.html#l00201">t_history::list</a>.</p>

<p class="reference">Referenced by <a class="el" href="history_8c_source.html#l00167">destroy_history()</a>.</p>

</div>
</div>
<a id="af6cfd171bf348ba5967396f960600478" name="af6cfd171bf348ba5967396f960600478"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6cfd171bf348ba5967396f960600478">&#9670;&#160;</a></span>init_history()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_history </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__history.html">t_history</a> *</td>          <td class="paramname"><span class="paramname"><em>history</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the history of the minishell. </p>
<p>Function used to initialise the static data of the history. If the history file is present, its contents get read into the history using <a class="el" href="#abdb3ff3b94e0a7d4212f4d6df994baf5" title="Reads history file into history.">read_history_file()</a>.</p>
<dl class="section author"><dt>Author</dt><dd>kmautner</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">history</td><td>history struct pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">success</td><td>Returns 0 on success, 1 otherwise. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="history_8c_source.html#l00105">105</a> of file <a class="el" href="history_8c_source.html">history.c</a>.</p>

<p class="reference">References <a class="el" href="error_8c_source.html#l00113">debug()</a>, <a class="el" href="ft__bzero_8c_source.html#l00015">ft_bzero()</a>, <a class="el" href="minishell_8h_source.html#l00066">HISTORY_FILE</a>, <a class="el" href="history_8c_source.html#l00066">read_history_file()</a>, and <a class="el" href="error_8c_source.html#l00090">warn()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00082">init_main()</a>.</p>

</div>
</div>
<a id="abdb3ff3b94e0a7d4212f4d6df994baf5" name="abdb3ff3b94e0a7d4212f4d6df994baf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdb3ff3b94e0a7d4212f4d6df994baf5">&#9670;&#160;</a></span>read_history_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_history_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__history.html">t_history</a> *</td>          <td class="paramname"><span class="paramname"><em>history</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>fd</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads history file into history. </p>
<p>This funciton is used to open the history file and add its contents to the current history. Should the file not exist or be unopenable this function is skipped. Should the reading of the file fail it will stop execution at that point. Any entries after the fail will not get loaded into memory.</p>
<dl class="section author"><dt>Author</dt><dd>kmautner</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">history</td><td>history struct </td></tr>
    <tr><td class="paramname">fd</td><td>file descriptor of the opened history file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">success</td><td>Returns 0 on success, 1 on error. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="history_8c_source.html#l00066">66</a> of file <a class="el" href="history_8c_source.html">history.c</a>.</p>

<p class="reference">References <a class="el" href="error_8c_source.html#l00113">debug()</a>, <a class="el" href="ft__strlen_8c_source.html#l00016">ft_strlen()</a>, <a class="el" href="get__next__line_8c_source.html#l00086">get_next_line()</a>, <a class="el" href="history_8c_source.html#l00029">history_add()</a>, and <a class="el" href="error_8c_source.html#l00090">warn()</a>.</p>

<p class="reference">Referenced by <a class="el" href="history_8c_source.html#l00105">init_history()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="history_8c.html">history.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
